<!DOCTYPE html>
<html lang="ja">
<head><link rel="icon" type="image/png" href="icon.png">
<meta charset="UTF-8">
<title>こうにゃのチャットサイト</title>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

// 🔹 Firebase設定（自分のプロジェクトに置き換えてください）
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT_ID.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const messagesRef = ref(db,"messages");

// 🔹 名前ごとの色
const userColors = {};
function getColor(name){ 
  if(!userColors[name]) userColors[name] = '#' + Math.floor(Math.random()*16777215).toString(16); 
  return userColors[name]; 
}

// 🔹 音楽＋アニメーション
let audio = null;
const anim = document.getElementById("animation");

function playTrack(track){
  if(audio){ audio.pause(); audio.currentTime=0; }
  audio = new Audio(track);
  audio.volume = 1;
  audio.muted = false;
  audio.play().then(()=>{
    anim.style.animation="bounce 1s infinite alternate";
  }).catch(err=>{
    alert("音楽を再生できません。ファイル名やブラウザ設定を確認してください。");
  });
}

function stopTrack(){
  if(audio){ audio.pause(); audio.currentTime=0; anim.style.animation="none"; }
}

// 🔹 チャット送信
function sendMessage(){
  const name = document.getElementById("nameInput").value.trim() || "名無し";
  const text = document.getElementById("messageInput").value.trim();
  if(text!==""){
    push(messagesRef,{name,text,time:Date.now()});
    document.getElementById("messageInput").value="";
  }
}

// 🔹 チャット受信
onChildAdded(messagesRef,(snapshot)=>{
  const msg = snapshot.val();
  const div = document.getElementById("messages");
  const p = document.createElement("p");
  p.innerHTML = `<strong style="color:${getColor(msg.name)}">${msg.name}:</strong> ${msg.text}`;
  div.appendChild(p);
  div.scrollTop = div.scrollHeight;
});

// 🔹 ボタンイベント
window.addEventListener("DOMContentLoaded",()=>{
  document.getElementById("playBtn").addEventListener("click", ()=>{
    const track = document.getElementById("trackSelect").value;
    if(track) playTrack(track);
  });
  document.getElementById("stopBtn").addEventListener("click", stopTrack);
  document.getElementById("sendBtn").addEventListener("click", sendMessage);
  document.getElementById("openScratch").addEventListener("click", ()=>{
    window.open("https://scratch.mit.edu/projects/1208216134/","_blank");
  });
  document.getElementById("openScratch2").addEventListener("click", ()=>{
    window.open("https://scratch.mit.edu/projects/1205681026/","_blank");
  });
});

</script>
<style>
body{margin:0;font-family:Arial;display:flex;height:100vh;background:#121212;color:white;}
.left{flex:1;display:flex;flex-direction:column;padding:10px;}
.right{width:400px;display:flex;flex-direction:column;padding:10px;background:#1e1e1e;border-radius:10px 0 0 10px;}
button,select{padding:8px 12px;margin:3px 0;border:none;border-radius:5px;cursor:pointer;background:#4cafef;color:white;font-weight:bold;}
.animation{margin-top:10px;height:50px;border-radius:5px;background:#333;display:flex;align-items:center;justify-content:center;color:#4cafef;font-weight:bold;}
.messages{flex:1;overflow-y:auto;border-radius:5px;padding:5px;background:#222;margin-bottom:5px;}
.messages p{margin:3px 0;padding:3px 8px;border-radius:5px;word-wrap:break-word;}
.input-area{display:flex;gap:5px;}
.input-area input{flex:1;padding:5px;border-radius:5px;border:none;background:#444;color:white;}
@keyframes bounce{from{transform:scale(1);}to{transform:scale(1.2);}}
</style>
</head>
<body>

<div class="left">
  <select id="trackSelect">
    <option value="">曲を選択</option>
    <option value="sound.mp3">ハニーパイ</option>
    <option value="sound2.mp3">マイクラbgm</option>
    <option value="sound3.mp3">しゅわしゅわハニーレモン</option>
  </select>
  <button id="playBtn">▶再生</button>
  <button id="stopBtn">⏹停止</button>
  <button id="openScratch">戦車ゲームを開く</button>
  <button id="openScratch2">猫ゲームを開く</button>
  <div class="animation" id="animation">🎶 音に合わせて動くよ！</div>
  <div class="animation" id="animation">クレジット＝音楽＿ハニーパイ、モグシティ、しゅわしゅわハニーレモン　ゲーム＿自作</div>
</div>

<div class="right">
  <input type="text" id="nameInput" placeholder="名前">
  <div class="messages" id="messages"></div>
  <div class="input-area">
    <input type="text" id="messageInput" placeholder="メッセージを入力...">
    <button id="sendBtn">送信</button>
  </div>
</div>

</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>クリックボタン</title>
  <script>
    let count = 0;

    window.addEventListener("DOMContentLoaded", () => {
      const btn = document.getElementById("countBtn");
      const display = document.getElementById("counter");

      // 🔹 ページを開いたときに保存済みの値を読み込む
      const savedCount = localStorage.getItem("myCount");
      if (savedCount !== null) {
        count = parseInt(savedCount, 10);
      }
      display.textContent = "カウント: " + count;

      // 🔹 ボタンを押したら増やして保存
      btn.addEventListener("click", () => {
        count++;
        display.textContent = "カウント: " + count;
        localStorage.setItem("myCount", count); // ←保存
      });
    });
  </script>
</head>
<body>
  <p id="counter">カウント: 0</p>
  <button id="countBtn">押してね</button>
</body>
</html>